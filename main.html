<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>ç¦åˆ©ç¤¾æ–çƒæ©Ÿ ğŸ°</title>

<style>
body{
  font-family:"Microsoft JhengHei",sans-serif;
  background:#fef3c7;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}
.card{
  background:white;
  width:380px;
  padding:24px;
  border-radius:18px;
  box-shadow:0 12px 24px rgba(0,0,0,.15);
  text-align:center;
}
.machine{
  margin:16px auto;
  width:220px;
  height:260px;
  border-radius:16px;
  border:5px solid #999;
  background:#fff;
  position:relative;
  overflow:hidden;
}

/* çƒå¾ä¸Šé¢æ‰ä¸‹ä¾† */
.ball{
  width:22px;
  height:22px;
  border-radius:50%;
  position:absolute;
  left:50%;
  transform:translateX(-50%);
  top:-30px;
  animation:fall 1s ease-out forwards;
}

@keyframes fall{
  to{ top:220px; }
}

.yellow{ background:#facc15; }
.white{ background:#e5e7eb; }
.green{ background:#22c55e; }
.red{ background:#ef4444; }

.options{
  font-size:14px;
  text-align:left;
  margin:10px 0;
}
button{
  width:100%;
  padding:10px;
  font-size:16px;
  border:none;
  border-radius:10px;
  background:#f59e0b;
  color:white;
  cursor:pointer;
}

.result{
  margin-top:14px;
  background:#fff7ed;
  padding:12px;
  border-radius:10px;
  font-size:14px;
  line-height:1.6;
}
</style>
</head>

<body>
<div class="card">
  <h1>ğŸ° ç¦åˆ©ç¤¾æ–çƒæ©Ÿ</h1>

  <div class="options">
    <label><input type="checkbox" id="drink"> åŠ æŠ½é£²æ–™</label><br>
    <label><input type="checkbox" id="limit"> ç¸½é‡‘é¡ä¸è¶…é 60 å…ƒ</label>
  </div>

  <button onclick="start()">é–‹å§‹æ–</button>

  <div class="machine" id="machine"></div>

  <div class="result" id="result">æº–å‚™æ–çƒä¸­ ğŸ¯</div>
</div>

<script>
const mains = [
  {name:"é»å¿ƒéºµ",price:50},
  {name:"æ°´é¤ƒ",price:40},
  {name:"æ»·å‘³",price:35}
];
const luckyFoods = [
  {name:"èŒ¶è‘‰è›‹",price:11},
  {name:"é—œæ±ç…®",price:"random"}
];
const drinks = [
  {name:"éº¥é¦™",price:10},
  {name:"å¤§å¸ç®¡",price:30},
  {name:"å¯çˆ¾å¿…æ€",price:25},
  {name:"é˜¿è¯ç”°",price:25}
];

function dropBall(color, delay){
  setTimeout(()=>{
    const b = document.createElement("div");
    b.className = `ball ${color}`;
    document.getElementById("machine").appendChild(b);
  }, delay);
}

function start(){
  const machine = document.getElementById("machine");
  const result = document.getElementById("result");
  machine.innerHTML = "";
  result.innerHTML = "ğŸ° çƒçƒé–‹å§‹æ»¾å‹•â€¦â€¦";

  setTimeout(runLogic, 300);   // å¾ˆå¿«é€²å…¥é‚è¼¯
}

function runLogic(){
  const addDrink = drink.checked;
  const limit = limit.checked;

  while(true){
    let total = 0;
    let text = "";
    let delay = 0;

    // ä¸»é¤ï¼ˆé»ƒçƒï¼‰
    const main = mains[Math.floor(Math.random()*mains.length)];
    dropBall("yellow", delay);
    delay += 700;
    total += main.price;
    text += `ğŸŸ¡ ä¸»é¤ï¼š${main.name}ï¼ˆ${main.price} å…ƒï¼‰<br>`;

    const luck = Math.random();

    // å¹¸é‹åŠ æŠ½ï¼ˆç™½çƒï¼‰
    if(luck > 0.4){
      dropBall("white", delay);
      delay += 700;
      const lucky = luckyFoods[Math.floor(Math.random()*luckyFoods.length)];
      if(lucky.name==="é—œæ±ç…®"){
        const sticks = Math.random()<0.5?1:2;
        const p = sticks===1?15:30;
        total += p;
        text += `âšª åŠ æŠ½ï¼šé—œæ±ç…® ${sticks} ä¸²ï¼ˆ${p} å…ƒï¼‰<br>`;
      }else{
        total += 11;
        text += `âšª åŠ æŠ½ï¼šèŒ¶è‘‰è›‹ï¼ˆ11 å…ƒï¼‰<br>`;
      }
    }

    // é£²æ–™ï¼ˆç¶ çƒï¼‰
    if(addDrink){
      dropBall("green", delay);
      delay += 700;
      const d = drinks[Math.floor(Math.random()*drinks.length)];
      total += d.price;
      text += `ğŸŸ¢ é£²æ–™ï¼š${d.name}ï¼ˆ${d.price} å…ƒï¼‰<br>`;
    }

    // è¶…å¹¸é‹å¸ƒä¸ï¼ˆç´…çƒï¼‰
    if(luck > 0.8){
      dropBall("red", delay);
      delay += 700;
      const big = Math.random()<0.5;
      const p = big?18:12;
      total += p;
      text += `ğŸ”´ è¶…å¹¸é‹å¸ƒä¸ï¼ˆ${big?"å¤§":"å°"}ï¼Œ${p} å…ƒï¼‰<br>`;
    }

    if(!limit || total<=60){
      setTimeout(()=>{
        result.innerHTML = text + `<br>ğŸ’° ç¸½é‡‘é¡ï¼š<b>${total} å…ƒ</b>`;
      }, delay + 300); // ğŸ”¥ æœ€æ™šç´„ 4.5ï½5 ç§’
      break;
    }
  }
}
</script>
</body>
</html>
