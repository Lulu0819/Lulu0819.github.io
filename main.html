<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>ç·šä¸Šè½‰ç›¤</title>
<style>
body {
  font-family: "Microsoft JhengHei", sans-serif;
  background: #eef9ff;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding-top: 40px;
}

input {
  width: 320px;
  padding: 10px;
  font-size: 16px;
}

#wheel-container {
  position: relative;
  margin: 30px 0;
}

#wheel {
  width: 300px;
  height: 300px;
  border-radius: 50%;
  border: 8px solid #4aa3df;
  transition: transform 4s cubic-bezier(0.25, 0.1, 0.25, 1);
}

#pointer {
  position: absolute;
  top: -18px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 30px;
}

button {
  width: 300px;
  height: 50px;
  font-size: 18px;
  background: #4aa3df;
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
}

button:hover {
  background: #3691cc;
}

#result {
  margin-top: 20px;
  font-size: 20px;
  font-weight: bold;
}
</style>
</head>

<body>

<h2>ğŸ¡ ç·šä¸Šè½‰ç›¤</h2>
<input id="items" placeholder="è¼¸å…¥é¸é …ï¼Œç”¨é€—è™Ÿåˆ†éš”ï¼ˆA,B,Cï¼‰">

<div id="wheel-container">
  <div id="pointer">â–¼</div>
  <canvas id="wheel" width="300" height="300"></canvas>
</div>

<button id="spinBtn">é–‹å§‹è½‰ç›¤</button>

<div id="result"></div>

<script>
const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");
const btn = document.getElementById("spinBtn");
const result = document.getElementById("result");

let rotation = 0;
let items = [];

function drawWheel() {
  const size = canvas.width;
  const radius = size / 2;
  const angle = (2 * Math.PI) / items.length;

  ctx.clearRect(0, 0, size, size);

  items.forEach((item, i) => {
    ctx.beginPath();
    ctx.moveTo(radius, radius);
    ctx.arc(radius, radius, radius, i * angle, (i + 1) * angle);
    ctx.fillStyle = i % 2 === 0 ? "#a7d8ff" : "#d0ecff";
    ctx.fill();

    ctx.save();
    ctx.translate(radius, radius);
    ctx.rotate(i * angle + angle / 2);
    ctx.textAlign = "right";
    ctx.fillStyle = "#333";
    ctx.font = "16px sans-serif";
    ctx.fillText(item, radius - 10, 5);
    ctx.restore();
  });
}

btn.addEventListener("click", (e) => {
  items = document.getElementById("items").value
    .split(",")
    .map(i => i.trim())
    .filter(i => i);

  if (items.length < 2) {
    result.textContent = "è«‹è‡³å°‘è¼¸å…¥å…©å€‹é¸é …";
    return;
  }

  drawWheel();

  // åˆ¤æ–·é»æ“Šä½ç½®ï¼ˆä½œå¼Šé—œéµï¼‰
  const rect = btn.getBoundingClientRect();
  const clickX = e.clientX - rect.left;
  const ratio = clickX / rect.width;

  let chosenIndex;

  if (ratio < 0.1) {
    // å·¦é‚Š 10% â†’ ä½œå¼Šæ¨¡å¼
    chosenIndex = 0;
    console.log("ğŸ¯ ä½œå¼Šæ¨¡å¼");
  } else {
    // æ­£å¸¸å…¬å¹³
    chosenIndex = Math.floor(Math.random() * items.length);
  }

  const anglePerItem = 360 / items.length;
  const targetAngle = 360 * 5 + (360 - chosenIndex * anglePerItem - anglePerItem / 2);

  rotation += targetAngle;
  canvas.style.transform = `rotate(${rotation}deg)`;

  setTimeout(() => {
    result.textContent = `ğŸ‰ çµæœæ˜¯ï¼š${items[chosenIndex]}`;
  }, 4000);
});
</script>

</body>
</html>
